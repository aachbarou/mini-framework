<!DOCTYPE html>
<html>
<head>
    <title>DOM Ready Performance Test</title>
</head>
<body>
    <h1>DOM Ready Performance Test</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        const startTime = performance.now();
        
        function addResult(method, time) {
            results.innerHTML += `<p>${method}: ${time.toFixed(3)}ms</p>`;
        }
        
        // Test 1: window.onload
        const onloadStart = performance.now();
        const oldOnload = window.onload;
        window.onload = function() {
            if (oldOnload) oldOnload();
            addResult('window.onload', performance.now() - onloadStart);
        };
        
        // Test 2: document.onreadystatechange
        const readyStart = performance.now();
        document.onreadystatechange = function() {
            if (document.readyState !== 'loading') {
                addResult('onreadystatechange', performance.now() - readyStart);
            }
        };
        
        // Test 3: Immediate execution (our run method)
        const immediateStart = performance.now();
        addResult('Immediate execution', performance.now() - immediateStart);
        
        // Test 4: Check document.readyState
        const readyStateStart = performance.now();
        if (document.readyState !== 'loading') {
            addResult('readyState check', performance.now() - readyStateStart);
        }
        
        addResult('Script load time', performance.now() - startTime);
    </script>
</body>
</html>
